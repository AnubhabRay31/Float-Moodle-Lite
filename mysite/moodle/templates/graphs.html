{% load static %}
<!DOCTYPE html>
<html>
<head>
    <!--required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Chart_Page</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Bootstrap 5.1.3 CSS-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.6.0/font/bootstrap-icons.css">


    <!-- font awesome icon set -->
    <script src="https://kit.fontawesome.com/36b9677629.js" crossorigin="anonymous"></script>
    <!-- Separate Popper and Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous">
    </script>    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous">
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


    <style type="text/css">
        :root{
            --primary-color:  white;
            --secondary-color: black;
        }
        .dark-theme{
            --primary-color: black;
            --secondary-color: teal;
        }
        #canvas-holder {
            background-color: var(--primary-color);
            position: relative;
            top: 8px;
            left: 8px;
            right: 8px;
            bottom: 16px;
            width: 500px;
            height: 300px;
        }
        body {
          padding: 0px;
          background-color: var(--primary-color);
          color: var(--secondary-color);
          font-size: 25px;
        }

        .button {
          border: none;
          color: var(--primary-color);
          padding: 16px 32px;
          text-align: center;
          text-decoration: none;
          display: inline-block;
          font-size: 16px;
          margin: 4px 2px;
          transition-duration: 0.4s;
          cursor: pointer;
        }

        .button1 {
          border-radius: 26px;
          background-color: var(--primary-color);
          color: var(--secondary-color);
          border: 2px solid #00a843;/*green color*/

        }

        .button1:hover {
          border-radius: 26px;
          background-color: #00a843;
          color: var(--primary-color);
        }
        .button2 {
          border-radius: 26px;
          background-color: var(--primary-color);
          color: var(--secondary-color);
          border: 2px solid #f54a11;/*red color*/

        }

        .button2:hover {
          border-radius: 26px;
          background-color: #f54a11;
          color: var(--primary-color);
        }

        #icon{
            width: 30px;
            cursor: pointer;
        }

    </style>
</head>


<body>
  
<header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom" style="background-color: teal; position: sticky; top:0;">
  <a href="\" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none" style="pointer-events: none;">
  <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentcolor" style="color: white; margin-left: 0.5rem;" class="bi bi-heart-fill" viewBox="0 0 16 16">
   <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
  </svg>
  <span class="fs-4" style="color: white; margin-left: 1rem;"><b>MOODLE ~ LITE</b><br><strong style="font-size: 20px; color:beige;">Learning Made Easier</strong></span>
  </a>
  <ul class="nav flex-column">
    <li class="nav-item">
      <ul class="nav nav-pills">
        <li class="nav-item">
          <a href="{% url 'home' %}" class="nav-link button1" style="color: white;" aria-current="page">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-house-door-fill" style="color: white; margin-left: 0.5rem; margin-right: 0.5rem;" viewBox="0 0 16 16">
            <path d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5z"/>
            </svg>
          HOME
          </a>
        </li>
        <li class="nav-item"><a href="{% url 'userpage' %}" class="nav-link button1" style="color: white;">My Profile</a></li>
        <li class="nav-item"><a href="{% url 'logout' %}" class="nav-link button1" style="color: white;">Log Out</a></li><br>
      </ul>
    </li>
    <li class="nav-item"><a id="mytime" style="color: white; text-align: right; margin-left: 6.8rem;"></a></li>
  </ul>
</header>
 





    <h1 style="text-align: center;">Welcome to the Statistics page | <img id="icon" src="../../../static/images/moon.png" alt="moon.png" /></h1>
    <!-- <button type="button" onclick="toggle_mode()">Toggle Mode</button> -->
    <br>
    <a href="../{{role}}/"><button type="button" class="button button2" style="margin-left:2rem;">Return to your Dashboard</button></a>

    {% for course,g_per_course in grades.items %}
        <hr style="height:5px; color:teal; opacity:1;">
        <h3><i>{{course}}</i></h3><br>
        <ul style="list-style-type:none;">
        {% for g in g_per_course %}
            <hr style="height:5px; color:deeppink; width: 50%; opacity: 0.7; margin-top: -1.5rem; margin-bottom: 0.2rem;">
            <li>Assignment {{g.assignment_name}} in course {{g.course_code}}
                <button type="button" class="button button1" onclick="chartIt_{{forloop.counter}}_{{forloop.parentloop.counter}}({{g.mark_list}},{{forloop.counter}})">Generate Graph</button>
                <div style="display: inline-flex; position: relative;">
                <div id="canvas-holder" style="margin-left: 2rem;margin-right: 1rem;">
                    <canvas id="myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_bar" width="1" height="1"></canvas>
                </div>
                <div id="canvas-holder" style="margin-left: 2rem;margin-right: 1rem;">
                    <canvas id="myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_line" width="1" height="1"></canvas>
                </div>
                <div id="canvas-holder" style="margin-left: 2rem;margin-right: 1rem;">
                    <canvas id="myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_pie" width="1" height="1"></canvas>
                </div>              
                </div>
<!--                 <ul>
                {% for stud,marks in g.mark_list.items %}
                    <li>{{stud}} got {{marks}} </li>
                {% endfor %}
                </ul> -->
            </li>
        {% endfor %}
        </ul>
    {% endfor %}




<script> 
{% for course,g_per_course in grades.items %}
    {% for g in g_per_course %} 
        function chartIt_{{forloop.counter}}_{{forloop.parentloop.counter}}(mark_list,id) {
            var xvalues = Object.keys(mark_list);
            var yvalues = Object.values(mark_list);
            console.log(xvalues,yvalues)
            const labels = xvalues;
            const mydata = {
                labels: labels,
                datasets: [{
                    label: 'Mark list',
                    backgroundColor: 'rgb(255, 99, 132)',
                    borderColor: 'rgb(255, 99, 132)',
                    borderWidth: 1,
                    data: yvalues,
                    backgroundColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)',
                    'rgba(145, 140, 45, 1)'
                    ],
                    borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)',
                    'rgba(145, 140, 45, 1)'
                    ],
                }]
            };
            const myconfig_bar = {
                type: 'bar',
                data: mydata,
                options: {
                    maintainAspectRatio: false, 
                    responsive: true,
                    scales: {
                    y: {
                        beginAtZero: true
                    }
                    }
                }    
            };
            const myconfig_line = {
                type: 'line',
                data: mydata,
                options: {
                    maintainAspectRatio: false, 
                    responsive: true,
                    scales: {
                    y: {
                        beginAtZero: true
                    }
                    }
                }
            };
            const myconfig_pie = {
                type: 'pie',
                data: mydata,
                options: {
                    maintainAspectRatio: false, 
                    responsive: true,
                }
            };          
            const myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_bar = new Chart(document.getElementById('myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_bar'),myconfig_bar);
            const myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_line = new Chart(document.getElementById('myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_line'),myconfig_line);
            const myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_pie = new Chart(document.getElementById('myChart_{{forloop.counter}}_{{forloop.parentloop.counter}}_pie'),myconfig_pie);           
            // const myChart_1 = new Chart(document.getElementById('myChart_1'),myconfig);
        }
    {% endfor %}
{% endfor %}
    

    var icon = document.getElementById("icon");
    icon.onclick = function(){
        document.body.classList.toggle("dark-theme");
        if(document.body.classList.contains("dark-theme"))
            // icon.src="https://drive.google.com/uc?export=view&id=1tUbr2SgeuEYE6xMbRtxV36Hg4ElNNRpe";//sun.png
            icon.src="../../../static/images/sun.png";
        else
            // icon.src="https://drive.google.com/uc?export=view&id=1bETxtX6TCfcEMAsf9yDWEtFo6xdcYaq9";//moon.png
            icon.src="../../../static/images/moon.png";
    }

</script>    

</body>
</html>